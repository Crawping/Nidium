--- leveldb/build_detect_platform.org	2017-02-25 01:13:18 -0800
+++ leveldb/build_detect_platform	2017-02-25 01:24:41 -0800
@@ -153,7 +153,7 @@
         PLATFORM_SHARED_CFLAGS=
         PLATFORM_SHARED_VERSIONED=
         ;;
-    OS_WINDOWS_CROSSCOMPILE | NATIVE_WINDOWS)
+    OS_WINDOWS_CROSSCOMPILE)
         PLATFORM=OS_WINDOWS
         COMMON_FLAGS="-fno-builtin-memcmp -D_REENTRANT -DOS_WINDOWS -DLEVELDB_PLATFORM_WINDOWS -DWINVER=0x0500 -D__USE_MINGW_ANSI_STDIO=1"
         PLATFORM_SOURCES="util/env_win.cc"
@@ -161,6 +161,15 @@
         PORT_FILE=port/port_win.cc
         CROSS_COMPILE=true
         ;;
+     NATIVE_WINDOWS)
+        PLATFORM=OS_WINDOWS
+        COMMON_FLAGS="-D_REENTRANT -DOS_WINDOWS -DLEVELDB_PLATFORM_WINDOWS -DWINVER=0x0500 -D__USE_MINGW_ANSI_STDIO=1"
+        PLATFORM_SOURCES="util/env_win.cc"
+        PLATFORM_LIBS="-lshlwapi"
+        PLATFORM_SHARED_LDFLAGS=
+        PORT_FILE=port/port_win.cc
+        CROSS_COMPILE=true
+        ;;
     *)
         echo "Unknown platform!" >&2
         exit 1
